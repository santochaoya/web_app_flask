# Create Users

## Hash password

Here, we use **Bcrypt** to hash our password. After we registering the account, the application will hash the password and save it to the database.



### Install

```python
pip install flask-bcrypt
```



### Hash password

#### Generate hashed password

```python
from flask_bcrypt import Bcrypt

bcrypt = Bcrypt()
bcrypt.generate_password_hash('testing')
```

It will generate a bites hashed code.

```bash
b'$2b$12$g0YpQMfeF3Y8pIumUHQSfOjqpjBMFgTKmrgU0xCevRBhotnUj0nNO'
```

or getting a string from ```utf-8```

```python
bcrypt.generate_password_hash('testing').decode('utf-8')
```

```bash
'$2b$12$sBJ/cDKNox7puebep9nvNu1obucpVYvUuxfUXQHFvD3v1Dj272BLO'
```



#### Check hashed password

```python
hash_pw = bcrypt.generate_password_hash('testing').decode('utf-8')
bcrypt.check_password_hash(hash_pw, 'testing')
```

```bash
>> True
```

```python
bcrypt.check_password_hash(hash_pw, 'password')
```

```
>> False
```



## Create users

* ```__init__.py```

  ```python
  from flask_bcrypt import Bcrypt
  
  bcrypt = Bcrypt(app)
  ```



* ```routes.py```

  ```python
  from flaskbloc import app, db, bcrypt
  
  # <-- inside the register function -->
  if form.validation_on_submit():
    	hashed_password = bcrypt.generate_password_hash(form.password.data).decode('utf-8')
      user = User(username=form.username.data, email=form.email.data, password=hashed_password)
      # Add user to database
      db.session.add(user)
      db.session.commit()
  ```

   

## Add only valid users to database

### Existing username

We add some error message in the front-end to indicate that issue in a function.

```python
from flaskblog.models import User
from wtforms.validators import ValidationError
# <-- in the form.py/RegistrationForm(FlaskForm) -->

def validate_username(self, username):
  	user = User.query.filter_by(username=username.data).first()
		if user:
      	raise ValidationError('Username exists, please choose another one.')
```



###  Unique email

```python
def validate_email(self, email):
		email = User.query.filter_by(email=email.data).first()
		if email:
				raise ValidationError('Email exists, please chosse another one.')
```



# Login & Logout

